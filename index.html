<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qüestionari Educatiu Millorat</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --font-size-base: 16px;
            --font-size-lg: 18px;
            --font-size-xl: 20px;
            --line-height: 1.5;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: var(--font-size-base);
            line-height: var(--line-height);
            color: var(--dark-color);
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: var(--font-size-xl);
        }
        
        .question-info {
            background-color: var(--light-color);
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .question-text {
            font-size: var(--font-size-lg);
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        /* Estils per a preguntes d'opció múltiple */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .option {
            display: flex;
            align-items: flex-start;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background-color: white;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
        }
        
        .option.selected {
            border-color: var(--primary-color);
            background-color: #e6f2ff;
        }
        
        .option input {
            margin-right: 12px;
            margin-top: 3px;
            transform: scale(1.2);
        }
        
        .option-label {
            font-weight: 500;
        }
        
        /* Estils per a preguntes vertader/fals */
        .true-false-container {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .true-false-option {
            flex: 1;
            text-align: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            background-color: white;
        }
        
        .true-false-option:hover {
            border-color: var(--primary-color);
            background-color: #f0f7ff;
        }
        
        .true-false-option.selected.true {
            border-color: var(--success-color);
            background-color: #e8f5e8;
        }
        
        .true-false-option.selected.false {
            border-color: var(--danger-color);
            background-color: #fde8e8;
        }
        
        /* Estils per a preguntes de desenvolupament */
        .development-question {
            margin-bottom: 25px;
        }
        
        .development-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            font-size: var(--font-size-base);
            line-height: var(--line-height);
            resize: vertical;
            transition: border-color 0.2s;
        }
        
        .development-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        /* Botons */
        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .submit-btn:hover {
            background-color: var(--secondary-color);
        }
        
        .next-btn {
            background-color: var(--success-color);
            color: white;
        }
        
        .next-btn:hover {
            background-color: #218838;
        }
        
        .prev-btn {
            background-color: #6c757d;
            color: white;
        }
        
        .prev-btn:hover {
            background-color: #5a6268;
        }
        
        /* Sistema de qualificació */
        .grading-system {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .grade-title {
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .grade-levels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .grade-level {
            text-align: center;
            flex: 1;
            padding: 5px;
            font-weight: 500;
        }
        
        .grade-level.insufficient {
            color: var(--danger-color);
        }
        
        .grade-level.sufficient {
            color: #fd7e14;
        }
        
        .grade-level.good {
            color: var(--warning-color);
        }
        
        .grade-level.notable {
            color: #20c997;
        }
        
        .grade-level.excellent {
            color: var(--success-color);
        }
        
        /* Feedback */
        .feedback-container {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: #e8f4f8;
            border-left: 4px solid var(--primary-color);
            display: none; /* Ocult per defecte */
        }
        
        .feedback-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        
        .feedback-content {
            line-height: 1.6;
        }
        
        .grade-indicator {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .grade-indicator.insufficient {
            background-color: #f8d7da;
            color: var(--danger-color);
        }
        
        .grade-indicator.sufficient {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .grade-indicator.good {
            background-color: #e2f0fb;
            color: #0c5460;
        }
        
        .grade-indicator.notable {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .grade-indicator.excellent {
            background-color: #d4edda;
            color: var(--success-color);
        }
        
        /* Llista de preguntes */
        .questions-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .question-item {
            padding: 10px 15px;
            background-color: var(--light-color);
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .question-item:hover {
            background-color: #e9ecef;
        }
        
        .question-item.current {
            background-color: var(--primary-color);
            color: white;
        }
        
        .question-item.answered {
            background-color: #d4edda;
            color: var(--success-color);
            font-weight: 500;
        }
        
        /* Millores d'accessibilitat */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        .high-contrast {
            color: #000;
            background-color: #fff;
        }
        
        /* Responsivitat */
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .true-false-container {
                flex-direction: column;
            }
            
            .grade-levels {
                flex-direction: column;
                gap: 5px;
            }
            
            .button-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .button-container button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="home-page">
        <h1>Qüestionari d'Història: L'Imperi Romà</h1>
        <p>Aquest qüestionari conté 5 preguntes sobre les causes de la crisi de l'Imperi Romà d'Occident.</p>
        
        <div class="questions-list" id="questions-list">
            <!-- Les preguntes es generaran dinàmicament -->
        </div>
        
        <div class="button-container">
            <button id="start-btn" class="submit-btn">Començar el qüestionari</button>
        </div>
    </div>

    <div class="container" id="question-page" style="display: none;">
        <h1>Questionari unificat: SA1.1 a SA1.4</h1>
        
        <div class="question-info" id="question-info">SA1.1 - 1/5</div>
        
        <div class="question-text" id="question-text">
            Quin dels següents factors va ser una causa política de la crisi de l'Imperi Romà d'Occident?
        </div>
        
        <div class="options-container" id="options-container">
            <!-- Les opcions es generaran dinàmicament -->
        </div>
        
        <div class="true-false-container" id="true-false-container" style="display: none;">
            <div class="true-false-option true">Vertader</div>
            <div class="true-false-option false">Fals</div>
        </div>
        
        <div class="development-question" id="development-question" style="display: none;">
            <textarea class="development-textarea" id="development-textarea" placeholder="Escriu la teva resposta aquí..."></textarea>
        </div>
        
        <div class="grading-system" id="grading-system" style="display: none;">
            <div class="grade-title">Sistema de qualificació per a respostes de desenvolupament:</div>
            <div class="grade-levels">
                <div class="grade-level insufficient">Insuficient</div>
                <div class="grade-level sufficient">Suficient</div>
                <div class="grade-level good">Bé</div>
                <div class="grade-level notable">Notable</div>
                <div class="grade-level excellent">Excel·lent</div>
            </div>
            <div>
                Les respostes s'avaluen segons la precisió, completitud, coherència i profunditat de l'anàlisi.
            </div>
        </div>
        
        <div class="feedback-container" id="feedback-container">
            <div class="feedback-title">Feedback de la resposta:</div>
            <div class="grade-indicator" id="grade-indicator">Qualificació: </div>
            <div class="feedback-content" id="feedback-content"></div>
        </div>
        
        <div class="button-container">
            <button id="prev-btn" class="prev-btn">Pregunta anterior</button>
            <button id="submit-btn" class="submit-btn">Envia la resposta</button>
            <button id="next-btn" class="next-btn">Següent pregunta</button>
        </div>
    </div>

    <script>
        // Dades de les preguntes
        const questions = [
            {
                id: 1,
                code: "SA1.1",
                text: "Quin dels següents factors va ser una causa política de la crisi de l'Imperi Romà d'Occident?",
                type: "multiple-choice",
                options: [
                    "La pèrdua de terres cultivables per l'erosió.",
                    "La inestabilitat i les guerres civils per la successió imperial.",
                    "La importació massiva de seda de la Xina.",
                    "L'aparició de noves tecnologies militars."
                ],
                correctAnswer: 1, // Índex de l'opció correcta (0-based)
                userAnswer: null,
                feedback: {
                    insufficient: "La teva resposta no és correcta. La causa política principal era la inestabilitat i les guerres civils per la successió imperial.",
                    sufficient: "Has encertat la resposta, però no has proporcionat una explicació addicional.",
                    good: "Has identificat correctament la causa política. Podries mencionar com aquesta inestabilitat afeblia l'imperi.",
                    notable: "Bona resposta. Has reconegut la inestabilitat successòria com a causa política.",
                    excellent: "Excel·lent! Has identificat correctament la causa política i possiblement has proporcionat context addicional."
                }
            },
            {
                id: 2,
                code: "SA1.2",
                text: "L'Imperi Romà d'Occident va caure l'any 476 d.C.",
                type: "true-false",
                correctAnswer: true, // true per a vertader, false per a fals
                userAnswer: null,
                feedback: {
                    insufficient: "La resposta no és correcta. L'Imperi Romà d'Occident va caure efectivament l'any 476 d.C.",
                    sufficient: "Has encertat que és vertader, però no has donat més detalls.",
                    good: "Correcte, l'any 476 d.C. és àmpliament acceptat com la data de la caiguda de l'Imperi Romà d'Occident.",
                    notable: "Molt bé, has encertat la data de la caiguda de l'Imperi Romà d'Occident.",
                    excellent: "Excel·lent! Has encertat la data i possiblement has donat context històric addicional."
                }
            },
            {
                id: 3,
                code: "SA1.3",
                text: "Explica les principals causes econòmiques de la crisi de l'Imperi Romà d'Occident.",
                type: "development",
                userAnswer: null,
                feedback: {
                    insufficient: "La teva resposta és massa breu o no aborda les causes econòmiques principals. Intenta mencionar la inflació, la depreciació de la moneda o la crisi fiscal.",
                    sufficient: "Has esmentat alguna causa econòmica, però la resposta és limitada. Proporciona més detalls sobre com aquestes causes van afectar l'imperi.",
                    good: "Has identificat algunes causes econòmiques rellevants. Podries aprofundir en com interactuaven amb altres factors.",
                    notable: "Bona anàlisi de les causes econòmiques. Has esmentat elements clau com la crisi fiscal o la inflació.",
                    excellent: "Resposta excel·lent. Has analitzat en profunditat les causes econòmiques i la seva relació amb la crisi general de l'imperi."
                }
            },
            {
                id: 4,
                code: "SA1.4",
                text: "Quin va ser el darrer emperador romà d'Occident?",
                type: "multiple-choice",
                options: [
                    "Julius Cèsar",
                    "Constantí el Gran",
                    "Ròmul Augústul",
                    "Marc Aureli"
                ],
                correctAnswer: 2, // Ròmul Augústul
                userAnswer: null,
                feedback: {
                    insufficient: "La resposta no és correcta. El darrer emperador va ser Ròmul Augústul.",
                    sufficient: "Has encertat, Ròmul Augústul va ser el darrer emperador romà d'Occident.",
                    good: "Correcte, Ròmul Augústul va ser deposat per Odoacre l'any 476 d.C.",
                    notable: "Molt bé, has identificat correctament a Ròmul Augústul com el darrer emperador.",
                    excellent: "Excel·lent! Has encertat el nom i possiblement has proporcionat context històric sobre la seva deposició."
                }
            },
            {
                id: 5,
                code: "SA1.5",
                text: "Les invasions barbares van ser l'única causa de la caiguda de l'Imperi Romà d'Occident.",
                type: "true-false",
                correctAnswer: false,
                userAnswer: null,
                feedback: {
                    insufficient: "La resposta no és correcta. Les invasions barbares van ser un factor important, però no l'única causa.",
                    sufficient: "Has encertat que és fals, però no has explicat quines altres causes van existir.",
                    good: "Correcte, les invasions barbares van ser un factor, però també hi va haver causes polítiques, econòmiques i socials.",
                    notable: "Molt bé, has reconegut que la caiguda de l'imperi va ser multicausal.",
                    excellent: "Excel·lent! Has identificat correctament que les invasions barbares van ser només un factor entre molts altres."
                }
            }
        ];

        // Variables globals
        let currentQuestionIndex = 0;
        let userAnswers = Array(questions.length).fill(null);

        // Elements del DOM
        const homePage = document.getElementById('home-page');
        const questionPage = document.getElementById('question-page');
        const questionsList = document.getElementById('questions-list');
        const startBtn = document.getElementById('start-btn');
        const questionInfo = document.getElementById('question-info');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const trueFalseContainer = document.getElementById('true-false-container');
        const developmentQuestion = document.getElementById('development-question');
        const developmentTextarea = document.getElementById('development-textarea');
        const gradingSystem = document.getElementById('grading-system');
        const feedbackContainer = document.getElementById('feedback-container');
        const gradeIndicator = document.getElementById('grade-indicator');
        const feedbackContent = document.getElementById('feedback-content');
        const prevBtn = document.getElementById('prev-btn');
        const submitBtn = document.getElementById('submit-btn');
        const nextBtn = document.getElementById('next-btn');

        // Inicialització
        document.addEventListener('DOMContentLoaded', function() {
            // Generar llista de preguntes a la pàgina inicial
            generateQuestionsList();
            
            // Configurar esdeveniments
            startBtn.addEventListener('click', startQuiz);
            prevBtn.addEventListener('click', showPreviousQuestion);
            submitBtn.addEventListener('click', submitAnswer);
            nextBtn.addEventListener('click', showNextQuestion);
            
            // Configurar esdeveniments per a les opcions
            setupOptionEvents();
        });

        function generateQuestionsList() {
            questions.forEach((question, index) => {
                const questionItem = document.createElement('div');
                questionItem.className = 'question-item';
                questionItem.textContent = `${question.code} - ${index + 1}`;
                questionItem.addEventListener('click', () => {
                    currentQuestionIndex = index;
                    showQuestion();
                    homePage.style.display = 'none';
                    questionPage.style.display = 'block';
                });
                questionsList.appendChild(questionItem);
            });
        }

        function startQuiz() {
            currentQuestionIndex = 0;
            showQuestion();
            homePage.style.display = 'none';
            questionPage.style.display = 'block';
        }

        function showQuestion() {
            const question = questions[currentQuestionIndex];
            
            // Actualitzar informació de la pregunta
            questionInfo.textContent = `${question.code} - ${currentQuestionIndex + 1}/${questions.length}`;
            questionText.textContent = question.text;
            
            // Amagar tots els contenidors
            optionsContainer.style.display = 'none';
            trueFalseContainer.style.display = 'none';
            developmentQuestion.style.display = 'none';
            gradingSystem.style.display = 'none';
            feedbackContainer.style.display = 'none';
            
            // Mostrar el contenidor adequat segons el tipus de pregunta
            if (question.type === 'multiple-choice') {
                showMultipleChoiceQuestion(question);
            } else if (question.type === 'true-false') {
                showTrueFalseQuestion(question);
            } else if (question.type === 'development') {
                showDevelopmentQuestion(question);
            }
            
            // Actualitzar l'estat dels botons
            updateNavigationButtons();
            
            // Actualitzar la llista de preguntes
            updateQuestionsList();
        }

        function showMultipleChoiceQuestion(question) {
            optionsContainer.style.display = 'flex';
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (userAnswers[currentQuestionIndex] === index) {
                    optionElement.classList.add('selected');
                }
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = 'question';
                input.value = index;
                input.id = `option${index}`;
                input.checked = userAnswers[currentQuestionIndex] === index;
                
                const label = document.createElement('label');
                label.className = 'option-label';
                label.htmlFor = `option${index}`;
                label.textContent = option;
                
                optionElement.appendChild(input);
                optionElement.appendChild(label);
                
                optionElement.addEventListener('click', () => {
                    document.querySelectorAll('.option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    optionElement.classList.add('selected');
                    input.checked = true;
                    userAnswers[currentQuestionIndex] = index;
                });
                
                optionsContainer.appendChild(optionElement);
            });
        }

        function showTrueFalseQuestion(question) {
            trueFalseContainer.style.display = 'flex';
            
            const trueOption = trueFalseContainer.querySelector('.true');
            const falseOption = trueFalseContainer.querySelector('.false');
            
            // Restablir estats
            trueOption.classList.remove('selected');
            falseOption.classList.remove('selected');
            
            // Marcar l'opció seleccionada si n'hi ha una
            if (userAnswers[currentQuestionIndex] !== null) {
                if (userAnswers[currentQuestionIndex] === true) {
                    trueOption.classList.add('selected');
                } else {
                    falseOption.classList.add('selected');
                }
            }
            
            // Configurar esdeveniments
            trueOption.addEventListener('click', () => {
                trueOption.classList.add('selected');
                falseOption.classList.remove('selected');
                userAnswers[currentQuestionIndex] = true;
            });
            
            falseOption.addEventListener('click', () => {
                falseOption.classList.add('selected');
                trueOption.classList.remove('selected');
                userAnswers[currentQuestionIndex] = false;
            });
        }

        function showDevelopmentQuestion(question) {
            developmentQuestion.style.display = 'block';
            gradingSystem.style.display = 'block';
            
            // Restablir l'àrea de text
            developmentTextarea.value = userAnswers[currentQuestionIndex] || '';
        }

        function setupOptionEvents() {
            // Aquest mètode ja no és necessari perquè els esdeveniments es configuren individualment
        }

        function updateNavigationButtons() {
            // Amagar/mostrar botons segons la posició actual
            prevBtn.style.display = currentQuestionIndex === 0 ? 'none' : 'block';
            nextBtn.style.display = currentQuestionIndex === questions.length - 1 ? 'none' : 'block';
            
            // Canviar el text del botó de següent si és l'última pregunta
            if (currentQuestionIndex === questions.length - 1) {
                nextBtn.textContent = 'Veure resultats';
            } else {
                nextBtn.textContent = 'Següent pregunta';
            }
        }

        function updateQuestionsList() {
            const questionItems = questionsList.querySelectorAll('.question-item');
            questionItems.forEach((item, index) => {
                item.classList.remove('current');
                if (index === currentQuestionIndex) {
                    item.classList.add('current');
                }
                
                // Marcar les preguntes respostes
                if (userAnswers[index] !== null) {
                    item.classList.add('answered');
                } else {
                    item.classList.remove('answered');
                }
            });
        }

        function submitAnswer() {
            const question = questions[currentQuestionIndex];
            
            // Guardar la resposta per a preguntes de desenvolupament
            if (question.type === 'development') {
                userAnswers[currentQuestionIndex] = developmentTextarea.value;
            }
            
            // Verificar si s'ha donat una resposta
            if (userAnswers[currentQuestionIndex] === null) {
                alert('Si us plau, selecciona una resposta abans d\'enviar.');
                return;
            }
            
            // Mostrar el feedback
            showFeedback(question);
        }

        function showFeedback(question) {
            // Determinar la qualificació (simulada)
            let grade = 'sufficient';
            
            // Per a preguntes d'opció múltiple i vertader/fals
            if (question.type === 'multiple-choice' || question.type === 'true-false') {
                const isCorrect = question.type === 'multiple-choice' 
                    ? userAnswers[currentQuestionIndex] === question.correctAnswer
                    : userAnswers[currentQuestionIndex] === question.correctAnswer;
                
                if (isCorrect) {
                    grade = 'excellent';
                } else {
                    grade = 'insufficient';
                }
            } else {
                // Per a preguntes de desenvolupament, simulem una avaluació basada en la longitud
                const answerLength = userAnswers[currentQuestionIndex].length;
                if (answerLength < 50) {
                    grade = 'insufficient';
                } else if (answerLength < 100) {
                    grade = 'sufficient';
                } else if (answerLength < 200) {
                    grade = 'good';
                } else if (answerLength < 300) {
                    grade = 'notable';
                } else {
                    grade = 'excellent';
                }
            }
            
            // Actualitzar el feedback
            gradeIndicator.textContent = `Qualificació: ${getGradeText(grade)}`;
            gradeIndicator.className = `grade-indicator ${grade}`;
            feedbackContent.textContent = question.feedback[grade];
            
            // Mostrar el contenidor de feedback
            feedbackContainer.style.display = 'block';
        }

        function getGradeText(grade) {
            const gradeTexts = {
                'insufficient': 'Insuficient',
                'sufficient': 'Suficient',
                'good': 'Bé',
                'notable': 'Notable',
                'excellent': 'Excel·lent'
            };
            return gradeTexts[grade];
        }

        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }

        function showNextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                // Si és l'última pregunta, mostrar resultats
                showResults();
            }
        }

        function showResults() {
            // Aquí es podrien mostrar els resultats finals
            alert('Has completat el qüestionari! Puntuació final: ' + calculateScore() + '/' + questions.length);
            
            // Tornar a la pàgina inicial
            homePage.style.display = 'block';
            questionPage.style.display = 'none';
        }

        function calculateScore() {
            let score = 0;
            questions.forEach((question, index) => {
                if (question.type === 'multiple-choice') {
                    if (userAnswers[index] === question.correctAnswer) {
                        score++;
                    }
                } else if (question.type === 'true-false') {
                    if (userAnswers[index] === question.correctAnswer) {
                        score++;
                    }
                } else {
                    // Per a preguntes de desenvolupament, considerem que estan correctes si tenen una longitud mínima
                    if (userAnswers[index] && userAnswers[index].length >= 50) {
                        score++;
                    }
                }
            });
            return score;
        }
    </script>
</body>
</html>